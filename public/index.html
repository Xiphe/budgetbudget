<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="script-src 'self' 'unsafe-inline';"
    />
    <title>BudgetBudget</title>
    <link href="./fonts/index.css" rel="stylesheet" />
    <script>
      const {
        remote: { nativeTheme, systemPreferences },
        ipcRenderer,
      } = window.require('electron');
      function setColors() {
        const accentColorHex = systemPreferences.getAccentColor();
        const highlightColors = `${(
          systemPreferences.getUserDefault('AppleHighlightColor', 'string') ||
          '9 92 220'
        )
          .split(' ')
          .slice(0, 3)
          .map((i) => Math.round(Number(i) * 255))
          .join(', ')}`;
        const accentColors = [
          parseInt(accentColorHex.substring(0, 2), 16),
          parseInt(accentColorHex.substring(2, 4), 16),
          parseInt(accentColorHex.substring(4, 6), 16),
        ].join(', ');

        document.querySelector(
          'html',
        ).style.cssText = `--highlight-colors: ${highlightColors}; --accent-colors: ${accentColors};`;
      }

      function setScheme() {
        const {
          shouldUseDarkColors,
          shouldUseHighContrastColors,
        } = nativeTheme;
        document.querySelector('html').dataset.theme = [
          shouldUseDarkColors ? 'dark' : 'light',
          shouldUseHighContrastColors && 'high-contrast',
        ]
          .filter(Boolean)
          .join('-');
      }
      setScheme();
      setColors();
      ipcRenderer.on('UPDATE_COLOR_PREFERENCES', setColors);
      ipcRenderer.on('UPDATE_SCHEME', setScheme);
    </script>
    <style>
      html {
        font-size: 0.85em;
      }
      html::after {
        z-index: 1000;
        border-radius: 4px;
        content: '';
        pointer-events: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        box-shadow: 0 0 0px 1px inset var(--outer-border);
      }
      body {
        margin: 0;
        padding: 0;
        font-family: 'Roboto';
      }
      hr {
        border: none;
        border-bottom: 1px solid var(--border-color);
      }
      * {
        box-sizing: border-box;
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
